import React, { useState, useEffect } from "react";

const CallBox = () => {
  const [isCallActive, setIsCallActive] = useState(false);
  const [callTime, setCallTime] = useState(0);
  const [muteActive, setMuteActive] = useState(false);
  const [holdActive, setHoldActive] = useState(false);
  const [transferActive, setTransferActive] = useState(false);

  useEffect(() => {
    let timer;
    if (isCallActive) {
      timer = setInterval(() => {
        setCallTime((prev) => prev + 1);
      }, 1000);
    }
    return () => clearInterval(timer);
  }, [isCallActive]);

  const formatTime = (seconds) => {
    const mins = Math.floor(seconds / 60).toString().padStart(2, "0");
    const secs = (seconds % 60).toString().padStart(2, "0");
    return `${mins}:${secs}`;
  };

  const handleCallToggle = () => {
    setIsCallActive(!isCallActive);
    if (isCallActive) {
      setCallTime(0);
    }
  };

  return (
    <div className="content_secondpart_call_callbox">
      <div className="callbox_top">
        <h5>بیمار قدیمی</h5>
      </div>

      <div className="circle">
        <div className="circle_element">
          <img
            className="callbox_img_element"
            src="https://s3-alpha-sig.figma.com/img/2d58/484d/bf61df8891bedd87e0db3ebb6a1e7d90?Expires=1746403200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=bu3D21c97j4agT5s185AqxAMUIjpEls-at6BcdlGy9N3pHjgl0iQfF0~AjvdEHh5p1j65QuM7qbhQr-zBk2p64w8AfSjBIpW4uTMynUOZkAXrToGEg3DMf3T9NPJan76mCzxRdbSM2luX1iGaqtTKrlNjFEGiNhGV8Ms6~R~xpeddsYXz7KYJNeXUnlPnypph1LO5VjBP1W0u7V07hiilnlPIofjPJsnq7xQCa1fZArL4rknZWUrEovUWpLQTyPF2KzNnD7ppM6f-BEvzZHTSgIRDXadm7R5MTAM2ILe1rlmxyTgm9JZRGMFSJ8ikTt07uMtXy7l8unvKJCq9cND1g__"
            alt=""
          />
        </div>
      </div>
      <div className="callbox_spaces"></div>

      <div className="callbox_content">
        <div className="content_div">
            <h2 className="callbox_title">مهدی غفاری</h2>
            <p className="callbox_duration">{formatTime(callTime)}</p>
            <p className="callbox_status">در حال ضبط تماس</p>
        </div>

        {isCallActive && (
          <div className="callbox_actions">
            <div
              className={`action_box ${muteActive ? "active" : ""}`}
              onClick={() => setMuteActive(!muteActive)}
            >
              <span className="material-icons">
<svg width="18" height="22" viewBox="0 0 18 22" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12.3151 6.44556V7.46056L6.85506 13.8306C6.13506 13.0693 5.68506 11.9493 5.68506 10.7506V6.44556C5.68506 4.64306 6.73506 3.14681 8.16006 2.71806C8.30256 2.67431 8.43756 2.81431 8.43756 2.98056V4.32806C8.43756 4.68681 8.69256 4.98431 9.00006 4.98431C9.30756 4.98431 9.56256 4.68681 9.56256 4.32806V2.98056C9.56256 2.81431 9.69756 2.67431 9.84006 2.71806C11.2651 3.14681 12.3151 4.64306 12.3151 6.44556Z" fill="#B2C6E3"/>
<path d="M14.8574 9.41186V10.8031C14.8574 14.3644 12.5099 17.2956 9.52495 17.6019V19.4656C9.52495 19.8069 9.29245 20.0781 8.99995 20.0781C8.70745 20.0781 8.47495 19.8069 8.47495 19.4656V17.6019C7.65745 17.5144 6.88495 17.2344 6.19495 16.7881L6.96745 15.8869C7.58245 16.2194 8.27245 16.4119 8.99995 16.4119C11.6549 16.4119 13.8149 13.8919 13.8149 10.8031V9.41186C13.8149 9.07936 14.0474 8.80811 14.3399 8.80811C14.6249 8.80811 14.8574 9.07936 14.8574 9.41186Z" fill="#B2C6E3"/>
<path d="M12.3151 9.64819V10.9169C12.3151 13.1744 10.6501 14.9857 8.67005 14.7669C8.46005 14.7407 8.25005 14.6969 8.05505 14.6182L12.3151 9.64819Z" fill="#B2C6E3"/>
<path d="M16.3275 2.77939C16.1025 2.51689 15.735 2.51689 15.51 2.77939L5.42247 14.5481C4.64997 13.5594 4.18497 12.2469 4.18497 10.8031V9.41189C4.18497 9.07939 3.95247 8.80814 3.65997 8.80814C3.37497 8.80814 3.14247 9.07939 3.14247 9.41189V10.8031C3.14247 12.5794 3.72747 14.1981 4.67997 15.4144L1.66497 18.9319C1.43997 19.1944 1.43997 19.6231 1.66497 19.8856C1.78497 20.0081 1.92747 20.0781 2.07747 20.0781C2.22747 20.0781 2.36997 20.0081 2.48247 19.8769L16.3275 3.72439C16.56 3.46189 16.56 3.04189 16.3275 2.77939Z" fill="#B2C6E3"/>
</svg>
</span>
              <span>بی‌صدا</span>
            </div>
            <div
              className={`action_box ${holdActive ? "active" : ""}`}
              onClick={() => setHoldActive(!holdActive)}
            >
              <span className="material-icons">
<svg width="13" height="16" viewBox="0 0 13 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect x="8.375" y="0.828125" width="4.5" height="15" rx="2" fill="#B2C6E3"/>
<rect x="0.125" y="0.828125" width="4.5" height="15" rx="2" fill="#B2C6E3"/>
</svg></span>
              <span>نگه داشتن</span>
            </div>
            <div
              className={`action_box ${transferActive ? "active" : ""}`}
              onClick={() => setTransferActive(!transferActive)}
            >
              <span className="material-icons">
<svg width="26" height="27" viewBox="0 0 26 27" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10.5632 14.7404L8.61876 14.7404C8.20884 14.7404 7.88301 14.4086 7.8725 13.9913C7.8725 13.8736 7.86725 13.7612 7.86725 13.6435C7.8725 12.5358 7.95659 11.455 8.1195 10.4009C8.28767 9.35208 8.53993 8.38893 8.88152 7.52744C9.23363 6.66595 9.68033 5.95429 10.2269 5.3978C10.5842 5.03394 10.9889 4.75034 11.4303 4.55771C11.877 4.35973 12.371 4.26341 12.9123 4.27947C13.5798 4.28482 14.1106 4.4935 14.4994 4.88947C14.6466 5.03929 14.7622 5.22122 14.8305 5.4192C14.9041 5.62253 14.9304 5.84192 14.8883 6.07736L14.3891 9.06849C14.3523 9.29858 14.2997 9.49121 14.2314 9.65708C14.1684 9.81761 14.0843 9.95673 13.9844 10.0584C13.8583 10.1868 13.6954 10.2778 13.5009 10.3259C13.3117 10.3794 13.0858 10.4062 12.8335 10.4062L12.0189 10.4223C11.9033 10.4223 11.8087 10.4651 11.7246 10.5507C11.6826 10.5935 11.6511 10.6363 11.6195 10.6898C11.5933 10.7487 11.5775 10.7968 11.5565 10.8396C11.4776 11.1125 11.4146 11.5085 11.3725 12.0222C11.3358 12.5412 11.3095 13.0816 11.3042 13.6435C11.3042 13.7505 11.3095 13.8629 11.3095 13.9699C11.3147 14.3926 10.9836 14.7404 10.5632 14.7404Z" fill="#B2C6E3"/>
<path d="M14.5257 22.3921C14.3786 22.5419 14.1999 22.6703 14.0002 22.7666C13.9424 22.7934 13.8846 22.8201 13.8215 22.8415C13.543 22.9432 13.2487 23.0074 12.9281 23.0235C12.3868 23.0502 11.8981 22.97 11.4461 22.7773C11.4408 22.772 11.4303 22.772 11.4251 22.7666C10.9889 22.5794 10.5842 22.3065 10.2216 21.9373C9.68557 21.3915 9.23887 20.6798 8.89202 19.8023C8.54517 18.9247 8.28766 17.9562 8.12474 16.9021C8.07219 16.5382 8.01964 16.1744 7.9881 15.8105L11.4251 15.8105C11.4619 16.0727 11.5092 16.2921 11.5617 16.4633C11.5775 16.5008 11.5932 16.5489 11.6143 16.6024C11.6405 16.6613 11.6773 16.7095 11.7246 16.7576C11.814 16.8486 11.9138 16.886 12.0294 16.886L12.823 16.8914C13.0858 16.8914 13.3117 16.9181 13.4957 16.977C13.6901 17.0252 13.8478 17.1108 13.9792 17.2445C14.079 17.3462 14.1631 17.4746 14.2314 17.6405C14.2997 17.8064 14.3523 17.999 14.3943 18.2238L14.8988 21.2523C14.9409 21.4878 14.9251 21.6965 14.8515 21.8891C14.7727 22.0764 14.6729 22.2422 14.5257 22.3921Z" fill="#B2C6E3"/>
</svg>

<svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M8.41749 11.8065C8.30665 11.8065 8.19582 11.7657 8.10832 11.6782C7.93915 11.509 7.93915 11.229 8.10832 11.0599L11.34 7.82819L8.10832 4.59653C7.93915 4.42736 7.93915 4.14736 8.10832 3.97819C8.27749 3.80903 8.55749 3.80903 8.72665 3.97819L12.2675 7.51903C12.4367 7.68819 12.4367 7.96819 12.2675 8.13736L8.72665 11.6782C8.63915 11.7657 8.52832 11.8065 8.41749 11.8065Z" fill="#B2C6E3"/>
<path d="M11.8591 8.26562H2.04163C1.80246 8.26562 1.60413 8.06729 1.60413 7.82812C1.60413 7.58896 1.80246 7.39062 2.04163 7.39062H11.8591C12.0983 7.39062 12.2966 7.58896 12.2966 7.82812C12.2966 8.06729 12.0983 8.26562 11.8591 8.26562Z" fill="#B2C6E3"/>
</svg>
</span>
              <span>انتقال</span>
            </div>
          </div>
        )}

        <button
          className={`callbox_button ${isCallActive ? "end" : "start"}`}
          onClick={handleCallToggle}
        >
            
<svg width="36" height="37" viewBox="0 0 36 37" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16.4709 15.3315L16.4709 12.511C16.4709 11.9165 16.935 11.4438 17.519 11.4286C17.6837 11.4286 17.8409 11.421 18.0057 11.421C19.5554 11.4286 21.0677 11.5506 22.5426 11.7869C24.01 12.0308 25.3577 12.3967 26.563 12.8922C27.7684 13.4029 28.7642 14.0509 29.5428 14.8436C30.0519 15.362 30.4487 15.949 30.7182 16.5893C30.9952 17.2372 31.13 17.9538 31.1075 18.7389C31.1 19.7071 30.808 20.477 30.254 21.0411C30.0444 21.2545 29.7898 21.4222 29.5128 21.5213C29.2283 21.628 28.9214 21.6661 28.592 21.6052L24.4068 20.881C24.0849 20.8276 23.8154 20.7514 23.5833 20.6523C23.3587 20.5608 23.164 20.4389 23.0218 20.294C22.8421 20.1111 22.7148 19.8748 22.6475 19.5927C22.5726 19.3183 22.5352 18.9905 22.5352 18.6246L22.5127 17.4431C22.5127 17.2754 22.4528 17.1381 22.333 17.0162C22.2731 16.9552 22.2132 16.9095 22.1384 16.8637C22.056 16.8256 21.9886 16.8027 21.9287 16.7722C21.5469 16.6579 20.9929 16.5664 20.2741 16.5054C19.5479 16.4521 18.7918 16.414 18.0057 16.4063C17.8559 16.4063 17.6987 16.414 17.549 16.414C16.9575 16.4216 16.4709 15.9413 16.4709 15.3315Z" fill="white"/>
<path d="M5.76483 21.0792C5.5552 20.8658 5.37551 20.6066 5.24075 20.3169C5.20332 20.2331 5.16588 20.1492 5.13594 20.0578C4.99369 19.6537 4.90384 19.2269 4.88138 18.7619C4.84395 17.9767 4.95625 17.2678 5.22578 16.6122C5.23326 16.6046 5.23326 16.5893 5.24075 16.5817C5.50279 15.949 5.88461 15.3621 6.4012 14.8361C7.16485 14.0585 8.16059 13.4106 9.38842 12.9075C10.6163 12.4044 11.9714 12.0308 13.4463 11.7945C13.9554 11.7183 14.4645 11.6421 14.9736 11.5963L14.9736 16.5817C14.6067 16.6351 14.2997 16.7037 14.0602 16.7799C14.0078 16.8028 13.9404 16.8256 13.8655 16.8561C13.7832 16.8943 13.7158 16.9476 13.6484 17.0162C13.5211 17.1458 13.4687 17.2906 13.4687 17.4583L13.4612 18.6094C13.4612 18.9905 13.4238 19.3183 13.3414 19.5851C13.2741 19.8672 13.1543 20.0959 12.9671 20.2864C12.8249 20.4313 12.6452 20.5532 12.4131 20.6523C12.181 20.7514 11.9115 20.8277 11.597 20.8887L7.35951 21.6204C7.03009 21.6814 6.73811 21.6586 6.46858 21.5518C6.20655 21.4375 5.97445 21.2927 5.76483 21.0792Z" fill="white"/>
</svg>
          {isCallActive ? "قطع تماس" : "تماس"}
        </button>
      </div>
    </div>
  );
};

export default CallBox;